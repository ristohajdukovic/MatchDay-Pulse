<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Match Details – MatchDay Pulse</title>
  <link rel="stylesheet" href="./style.css" />
</head>
<body>
  <!-- HEADER -->
  <header id="site-header">
    <h1 id="app-title">MatchDay Pulse</h1>
    <nav id="app-nav" aria-label="Primary">
      <a href="./index.html">Calendar</a>
      <a href="./add.html">Add Match</a>
    </nav>
  </header>

  <main id="app" role="main">
    <!-- BACK BUTTON -->
    <div id="match-back">
      <a href="./index.html" class="back-btn">&larr; Back</a>
    </div>

    <!-- MATCH DETAILS SECTION -->
    <section id="match-details">
      <!-- Sport tag -->
      <div class="match-sport-tag">Football</div>

      <!-- Status tag -->
      <div class="match-status finished">Finished</div>
      <!-- If match is scheduled, use: <div class="match-status scheduled">To be played</div> -->

      <!-- Teams and score -->
      <div class="match-scoreboard">
        <div class="team-name home">Team A</div>
        <div class="score">
          <span class="home-score">2</span>
          <span class="dash">–</span>
          <span class="away-score">1</span>
        </div>
        <div class="team-name away">Team B</div>
      </div>

      <!-- Info row -->
      <div class="match-info-row">
        <div class="info-item">
          <span class="info-icon">📅</span>
          <span class="info-label">Date</span>
          <span class="info-value">2025-11-03</span>
        </div>
        <div class="info-item">
          <span class="info-icon">⏰</span>
          <span class="info-label">Time</span>
          <span class="info-value">18:30</span>
        </div>
        <div class="info-item">
          <span class="info-icon">🏟️</span>
          <span class="info-label">Stadium</span>
          <span class="info-value">Al Shabab Arena</span>
        </div>
      </div>
    </section>
  </main>


<script>
// Helper function (same as in script.js)
function createMatchId(match) {
  const date = match.dateVenue || "nodate";
  const homeName = match.homeTeam?.name || "unknown";
  const awayName = match.awayTeam?.name || "unknown";
  
  const home = homeName.toLowerCase().replace(/ /g, "-");
  const away = awayName.toLowerCase().replace(/ /g, "-");
  
  return date + "_" + home + "_" + away;
}

// Get the ID from URL
const params = new URLSearchParams(window.location.search);
const id = params.get("id");

if (id) {
  fetch("./matches.json")
    .then(res => res.json())
    .then(json => {
      const baseMatches = json.data || [];
      const addedMatches = sessionStorage.getItem("addedMatches");
      
      // Add IDs to base matches
      for (let i = 0; i < baseMatches.length; i++) {
        if (!baseMatches[i].id) {
          baseMatches[i].id = createMatchId(baseMatches[i]);
        }
      }
      
      // Get added matches and combine
      let allMatches = baseMatches;
      
      if (addedMatches) {
        const newMatches = JSON.parse(addedMatches);
        
        for (let i = 0; i < newMatches.length; i++) {
          allMatches.push(newMatches[i]);
        }
      }
      
      // Find the match with matching ID
      let match = null;
      for (let i = 0; i < allMatches.length; i++) {
        if (String(allMatches[i].id) === String(id)) {
          match = allMatches[i];
          break;
        }
      }
      
      if (!match) {
        console.log("Match not found");
        return;
      }

      // Display the match details
      document.querySelector(".match-sport-tag").textContent = match.sport || "Football";

      const statusEl = document.querySelector(".match-status");
      if (match.status === "played") {
        statusEl.textContent = "Finished";
        statusEl.className = "match-status finished";
      } else {
        statusEl.textContent = "To be played";
        statusEl.className = "match-status scheduled";
      }

      document.querySelector(".home").textContent = match.homeTeam?.name || "TBD";
      document.querySelector(".away").textContent = match.awayTeam?.name || "TBD";

      if (match.result && match.result.homeGoals != null) {
        document.querySelector(".home-score").textContent = match.result.homeGoals;
        document.querySelector(".away-score").textContent = match.result.awayGoals;
      } else {
        document.querySelector(".home-score").textContent = "-";
        document.querySelector(".away-score").textContent = "-";
      }

      const infoValues = document.querySelectorAll(".info-value");
      infoValues[0].textContent = match.dateVenue || "-";
      infoValues[1].textContent = match.timeVenueUTC || "-";
      infoValues[2].textContent = match.stadium || "Unknown";
    })
    .catch(err => console.error("Error loading match:", err));
}
</script>


</body>
</html>
